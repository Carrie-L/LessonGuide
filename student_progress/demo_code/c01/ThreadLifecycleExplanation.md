# çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸä¸volatileæœºåˆ¶è¯¦è§£

## ğŸ”„ å®Œæ•´æ‰§è¡Œæµç¨‹

### æƒ…å†µA: æ— volatile (å¯è§æ€§é—®é¢˜)
```
ä¸»çº¿ç¨‹                    Readerçº¿ç¨‹                Writerçº¿ç¨‹
  â”‚                         â”‚                         â”‚
  â”œâ”€reader.start()         â”œâ”€å¼€å§‹æ‰§è¡Œ                   â”‚
  â”œâ”€writer.start()         â”œâ”€while(!flag) [flag=false] â”‚
  â”‚                        â”œâ”€ç»§ç»­å¾ªç¯...                â”‚
  â”‚                        â”‚                         â”œâ”€sleep(1000)
  â”‚                        â”‚                         â”œâ”€flag=true (å†™å…¥ä¸»å†…å­˜)
  â”‚                        â”œâ”€while(!flag) [ä»è¯»å–false] â”œâ”€è¾“å‡º"å†™å…¥è€…..."
  â”‚                        â”œâ”€ç»§ç»­å¾ªç¯...                â”‚
  â”œâ”€sleep(3000)           â”œâ”€ç»§ç»­å¾ªç¯...                â”œâ”€ç»“æŸ
  â”œâ”€isAlive()=true        â”œâ”€ä»åœ¨å¾ªç¯...                â”‚
  â”œâ”€è¾“å‡º"å¯è§æ€§é—®é¢˜"        â”œâ”€ä»åœ¨å¾ªç¯...                â”‚
  â””â”€interrupt()           â””â”€è¢«ä¸­æ–­                    â”‚
```

### æƒ…å†µB: ä½¿ç”¨volatile (æ­£å¸¸æƒ…å†µ)
```
ä¸»çº¿ç¨‹                    Readerçº¿ç¨‹                Writerçº¿ç¨‹  
  â”‚                         â”‚                         â”‚
  â”œâ”€reader.start()         â”œâ”€å¼€å§‹æ‰§è¡Œ                   â”‚
  â”œâ”€writer.start()         â”œâ”€while(!flag) [flag=false] â”‚
  â”‚                        â”œâ”€ç»§ç»­å¾ªç¯...                â”‚
  â”‚                        â”‚                         â”œâ”€sleep(1000)
  â”‚                        â”‚                         â”œâ”€volatile flag=true
  â”‚                        â”œâ”€while(!flag) [è¯»å–true]   â”œâ”€è¾“å‡º"å†™å…¥è€…..."
  â”‚                        â”œâ”€é€€å‡ºwhileå¾ªç¯              â”‚
  â”‚                        â”œâ”€è¾“å‡º"reader end."         â”œâ”€ç»“æŸ
  â”‚                        â”œâ”€çº¿ç¨‹ç»“æŸ                  â”‚
  â”œâ”€sleep(3000)           â”‚                         â”‚
  â”œâ”€isAlive()=false       â”‚                         â”‚
  â””â”€è¾“å‡º"ok"               â”‚                         â”‚
```

## ğŸ¯ å…³é”®ç†è§£ç‚¹

1. **çº¿ç¨‹è‡ªåŠ¨ç»“æŸ**: å½“whileæ¡ä»¶ä¸ºfalseæ—¶ï¼Œçº¿ç¨‹è‡ªç„¶æ‰§è¡Œå®Œrun()æ–¹æ³•è€Œç»“æŸ
2. **volatileä¿è¯å¯è§æ€§**: ç¡®ä¿readerèƒ½çœ‹åˆ°writerçš„ä¿®æ”¹
3. **isAlive()æ£€æµ‹**: åˆ¤æ–­çº¿ç¨‹æ˜¯å¦è¢«å›°åœ¨å¾ªç¯ä¸­
4. **æ— éœ€join()**: æˆ‘ä»¬è¦æ£€æµ‹é—®é¢˜ï¼Œä¸æ˜¯ç­‰å¾…è§£å†³

## ğŸ’¡ volatile vs æ™®é€šå˜é‡

| å˜é‡ç±»å‹ | è¯»å–æ–¹å¼ | å¯è§æ€§ | ç»“æœ |
|---------|---------|--------|------|
| æ™®é€šå˜é‡ | ä»CPUç¼“å­˜ | å¯èƒ½è¿‡æœŸ | å¯èƒ½æ— é™å¾ªç¯ |
| volatileå˜é‡ | ä»ä¸»å†…å­˜ | ç«‹å³åŒæ­¥ | æ­£å¸¸ç»“æŸ |